---
import Layout from './Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

interface Props {
  frontmatter: {
    title: string;
    date: string;
    description?: string;
    image?: string;
    author?: string;
  };
}

const { frontmatter } = Astro.props;
const base = import.meta.env.BASE_URL;
const formattedDate = new Date(frontmatter.date).toLocaleDateString('ja-JP', {
  year: 'numeric',
  month: 'long',
  day: 'numeric'
});
---

<Layout title={frontmatter.title} description={frontmatter.description}>
  <Header />
  
  <main class="blog-post">
    <article class="container">
      <header class="post-header">
        <time datetime={frontmatter.date}>{formattedDate}</time>
        <h1>{frontmatter.title}</h1>
        {frontmatter.author && <p class="author">著者: {frontmatter.author}</p>}
      </header>
      
      {frontmatter.image && (
        <img src={frontmatter.image.startsWith('/') ? `${base}${frontmatter.image.slice(1)}` : frontmatter.image} alt={frontmatter.title} class="post-hero-image" />
      )}
      
      <div class="post-body">
        <slot />
      </div>
      
      <footer class="post-footer">
        <a href={`${base}/blog/`} class="back-link">← ブログ一覧に戻る</a>
      </footer>
    </article>
  </main>
  
  <Footer />
</Layout>

<style>
  .blog-post {
    padding-top: calc(var(--header-height) + var(--spacing-lg));
    padding-bottom: var(--spacing-xl);
  }
  
  .blog-post .container {
    max-width: 800px;
  }
  
  .post-header {
    text-align: center;
    margin-bottom: var(--spacing-md);
  }
  
  .post-header time {
    color: var(--color-text-light);
    font-size: 0.9rem;
  }
  
  .post-header h1 {
    margin: 0.5rem 0;
    font-size: 2rem;
  }
  
  .post-header .author {
    color: var(--color-text-light);
    font-size: 0.9rem;
  }
  
  .post-hero-image {
    width: 100%;
    max-height: 400px;
    object-fit: cover;
    border-radius: 8px;
    margin-bottom: var(--spacing-md);
  }
  
  .post-body {
    line-height: 1.9;
  }
  
  .post-body :global(h2) {
    margin-top: var(--spacing-md);
    margin-bottom: var(--spacing-sm);
    padding-bottom: 0.5rem;
    border-bottom: 2px solid var(--color-border);
  }
  
  .post-body :global(h3) {
    margin-top: var(--spacing-sm);
    margin-bottom: 0.5rem;
  }
  
  .post-body :global(p) {
    margin-bottom: 1.5rem;
  }
  
  .post-body :global(ul),
  .post-body :global(ol) {
    margin-bottom: 1.5rem;
    padding-left: 1.5rem;
  }
  
  .post-body :global(li) {
    margin-bottom: 0.5rem;
  }
  
  .post-body :global(blockquote) {
    border-left: 4px solid var(--color-accent);
    padding-left: var(--spacing-sm);
    margin: var(--spacing-sm) 0;
    color: var(--color-text-light);
    font-style: italic;
  }
  
  .post-body :global(code) {
    background: var(--color-bg-alt);
    padding: 0.2rem 0.4rem;
    border-radius: 4px;
    font-size: 0.9em;
  }
  
  .post-body :global(pre) {
    background: #1a202c;
    color: #e2e8f0;
    padding: var(--spacing-sm);
    border-radius: 8px;
    overflow-x: auto;
    margin-bottom: 1.5rem;
  }
  
  .post-body :global(pre code) {
    background: none;
    padding: 0;
  }
  
  .post-body :global(img) {
    border-radius: 8px;
    margin: var(--spacing-sm) 0;
  }
  
  .post-footer {
    margin-top: var(--spacing-lg);
    padding-top: var(--spacing-md);
    border-top: 1px solid var(--color-border);
  }
  
  .back-link {
    font-weight: 500;
  }
</style>
